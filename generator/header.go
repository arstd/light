package generator

import (
	"bytes"
	"text/template"

	"github.com/arstd/light/goparser"
	"github.com/arstd/log"
)

const textHeader = `
// !!! DO NOT EDIT THIS FILE. It is generated by 'light' tool.
// @light: https://github.com/arstd/light
// Generated from source: {{.Source}}
package {{.Package}}
import (
		"bytes"
		"fmt"
		"github.com/arstd/light/light"
		"github.com/arstd/light/null"
		{{- if .Log }}
			"github.com/arstd/log"
		{{- end}}

		{{- range $path, $short := .Imports}}
			{{$short}} "{{$path}}"
		{{- end}}
)

{{call .Init}}
`

var tplHeader = template.Must(template.New("textHeader").Parse(textHeader))

func writeHeader(store *goparser.Store) *bytes.Buffer {
	var buf bytes.Buffer
	log.Errorn(tplHeader.Execute(&buf, store))
	return &buf
}
